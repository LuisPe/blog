<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Hexagonal Architecture</title><meta name=description content="Como desacoplar nuestras capas del sistema correctamente"><meta name=keywords content="blog,luispe,developer,personal,experience,best-practices,golang,go"><meta property="og:url" content="https://luispe.github.io/blog/posts/hexagonal-architecture/"><meta property="og:type" content="website"><meta property="og:title" content="Hexagonal Architecture"><meta property="og:description" content="Como desacoplar nuestras capas del sistema correctamente"><meta property="og:image" content><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Hexagonal Architecture"><meta name=twitter:description content="Como desacoplar nuestras capas del sistema correctamente"><meta property="twitter:domain" content="https://luispe.github.io/blog/posts/hexagonal-architecture/"><meta property="twitter:url" content="https://luispe.github.io/blog/posts/hexagonal-architecture/"><meta name=twitter:image content><link rel=canonical href=https://luispe.github.io/blog/posts/hexagonal-architecture/><link rel=stylesheet type=text/css href=https://luispe.github.io/blog/css/normalize.min.css media=print onload="this.media='all'"><link rel=stylesheet type=text/css href=https://luispe.github.io/blog/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://luispe.github.io/blog/css/dark.css><script src=https://luispe.github.io/blog/js/svg-injector.min.js></script>
<script src=https://luispe.github.io/blog/js/feather-icons.min.js></script>
<script src=https://luispe.github.io/blog/js/main.js></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=nav-title><a class=nav-brand href=https://luispe.github.io/blog>luispe</a></div><div class=nav-links><div class=nav-link><a href=https://luispe.github.io/blog/>Home</a></div><div class=nav-link><a href=https://luispe.github.io/blog/about>About</a></div><div class=nav-link><a href=https://luispe.github.io/blog/posts/>Posts</a></div><div class=nav-link><a href=https://luispe.github.io/blog/tags/>Tags</a></div><div class=nav-link><a href=https://github.com/526avijitgupta/gokarna><span data-feather=github></span></a></div><div class=nav-link><a href=https://luispe.github.io/blog/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://luispe.github.io/blog/>Home</a></li><li class=nav-item><a href=https://luispe.github.io/blog/about>About</a></li><li class=nav-item><a href=https://luispe.github.io/blog/posts/>Posts</a></li><li class=nav-item><a href=https://luispe.github.io/blog/tags/>Tags</a></li><li class=nav-item><a href=https://github.com/526avijitgupta/gokarna><span data-feather=github></span></a></li><li class=nav-item><a href=https://luispe.github.io/blog/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Hexagonal Architecture</h1><small role=doc-subtitle>Como desacoplar nuestras capas del sistema correctamente</small><p class=post-date>June 9, 2022</p><ul class=post-tags><li class=post-tag><a href=https://luispe.github.io/tags/best-practices>best-practices</a></li><li class=post-tag><a href=https://luispe.github.io/tags/golang>golang</a></li><li class=post-tag><a href=https://luispe.github.io/tags/go>go</a></li></ul></div><div class=post-content><p><p>Esta es la primera de una serie donde vamos a revisar diferentes patrones de desarrollo que errores cometí y cuál es
en la actualidad y lo que entiendo hasta el momento, la mejor forma de aplicarlo.</p><p>Como bien dice el título de la publicación hoy quiero hablar sobre arquitectura hexagonal.</p><h2 id=preámbulo>Preámbulo</h2><p>Hace tiempo noto mucho &ldquo;hype&rdquo; en torno a la arquitectura hexagonal y me gustaría ser claro al respecto, no estoy en contra,
mas bien todo lo contrario, me parece un excelente patrón.</p><p>Pero creo que caemos en el error de aplicar la recetas de publicaciones de &ldquo;medium&rdquo; y no solo terminamos con todas las
capas de nuestro sistema acopladas sino que con nombres de packages al estilo &ldquo;adapters&rdquo; o &ldquo;ports&rdquo; y si hay algo hermoso
en el lenguaje de Go(lang) es la intencionalidad en el nombre de un package.</p><blockquote><p>Un buen nombre en el package hace que casi ni sea necesario nada más para expresar la intencionalidad del mismo.</p></blockquote><p>Te comparto y recomiendo leer la siguiente <a href=https://go.dev/blog/package-names>publicación oficial</a>, opinión personal,
aplica para cualquier lenguaje.</p><h2 id=comencemos>Comencemos</h2><blockquote><p>Anti patrón</p><p>Anotación en nuestro modelo de dominio e.g <code>json</code></p></blockquote><p>Un error que solía cometer es tener las anotaciones <code>json</code> o <code>validate</code> o cualquier anotación en el modelo de dominio.</p><p>Imaginemos que tenemos nuestro modelo <code>/user/user.go</code> con el siguiente contenido</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#6ab825;font-weight:700>type</span> User <span style=color:#6ab825;font-weight:700>struct</span> {
</span></span><span style=display:flex><span>	FirstName <span style=color:#6ab825;font-weight:700>string</span> <span style=color:#ed9d13>`json:&#34;first_name&#34;`</span>
</span></span><span style=display:flex><span>	LastName  <span style=color:#6ab825;font-weight:700>string</span> <span style=color:#ed9d13>`json:&#34;last_name&#34;`</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Antes de continuar leyendo te invito a que por unos segundos/minutos hagamos una reflexión de porque es un anti patrón.</p><h2 id=propuestaaprendizaje>Propuesta/aprendizaje</h2><p>Nuestro modelo debería ser agnóstico a la capa de presentación y a la de datos, por lo tanto, no debería contener ninguna
anotación. Deberíamos mapear los datos hacia nuestro modelo y viceversa, a continuación un ejemplo de como quedaría
un controlador rest HTTP e.g.:</p><p><code>user/rest_controller.go</code></p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#6ab825;font-weight:700>type</span> UserDTO <span style=color:#6ab825;font-weight:700>struct</span> {
</span></span><span style=display:flex><span>	FirstName <span style=color:#6ab825;font-weight:700>string</span> <span style=color:#ed9d13>`json:&#34;first_name&#34;`</span>
</span></span><span style=display:flex><span>	LastName  <span style=color:#6ab825;font-weight:700>string</span> <span style=color:#ed9d13>`json:&#34;last_name&#34;`</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>func</span> (ctrl *controller) <span style=color:#447fcf>toUserModel</span>(userDTO *UserDTO) *User {
</span></span><span style=display:flex><span>	<span style=color:#6ab825;font-weight:700>return</span> &amp;User{
</span></span><span style=display:flex><span>		FirstName:	userDTO.FirstName,
</span></span><span style=display:flex><span>		LastName:	userDTO.LastName,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>func</span> (ctrl *controller) <span style=color:#447fcf>toUserDTO</span>(user *User) *UserDTO {
</span></span><span style=display:flex><span>	<span style=color:#6ab825;font-weight:700>return</span> &amp;UserDTO{
</span></span><span style=display:flex><span>		FirstName:	user.FirstName,
</span></span><span style=display:flex><span>		LastName:	user.LastName,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Como podemos ver en el ejemplo anterior los metodos privados en el controlador rest mapean desde el <code>data transfer object</code>
hacia el modelo de dominio cuando llamemos al servicio y viceversa.</p><p>Por último quitamos las anotaciones en nuestro modelo <code>user/user.go</code></p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#6ab825;font-weight:700>type</span> User <span style=color:#6ab825;font-weight:700>struct</span> {
</span></span><span style=display:flex><span>	FirstName <span style=color:#6ab825;font-weight:700>string</span>
</span></span><span style=display:flex><span>	LastName  <span style=color:#6ab825;font-weight:700>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Todo bien luispi, ¿pero qué ganancia obtuvimos?</p><p>Ahora nuestro <code>/user/user.go</code> al no tener ninguna anotación no importa como presentemos o como obtengamos/persistamos
los datos, nunca vamos a tocar el core/dominio de nuestra aplicación, ahora si podríamos afirmar que nuestro core/dominio
es agnóstico a las capas de presentación o datos ganando flexibilidad, testabilidad, etc.</p><p>Para no aburrirte y por el momento hagamos una pausa.</p><p>Próximamente vamos a seguir con pequeñas publicaciones donde vamos a intentar repensar otros anti patrones.</p><p>¡Que pase bien!</p></p></div></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#preámbulo>Preámbulo</a></li><li><a href=#comencemos>Comencemos</a></li><li><a href=#propuestaaprendizaje>Propuesta/aprendizaje</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2022 luispe</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>